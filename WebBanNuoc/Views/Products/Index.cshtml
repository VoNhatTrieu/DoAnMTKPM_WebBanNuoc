@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@{
    ViewBag.Title = "Sản Phẩm";
    string category = ViewBag.Category ?? "";
    string sort = ViewBag.Sort ?? "";

    // Tiêu đề danh mục
    string categoryTitle = "Tất Cả Sản Phẩm";
    switch (category.ToLower())
    {
        case "tra-sua": categoryTitle = "Trà Sữa"; break;
        case "tra": categoryTitle = "Trà"; break;
        case "trai-cay": categoryTitle = "Trái Cây"; break;
        case "ca-phe": categoryTitle = "Cà Phê"; break;
        case "sinh-to": categoryTitle = "Sinh Tố"; break;
        case "nuoc-ep": categoryTitle = "Nước Ép"; break;
        case "soda": categoryTitle = "Soda"; break;
        case "banh-ngot": categoryTitle = "Bánh Ngọt"; break;
    }
}<div class="products-page">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Trang Chủ</a></li>
            <li class="breadcrumb-item active" aria-current="page">@categoryTitle</li>
        </ol>
    </nav>

    <!-- Page Header -->
    <div class="page-header mb-4">
        <h1 class="display-5 fw-bold">@categoryTitle</h1>
        <p class="text-muted">Khám phá các món đồ uống tuyệt vời của chúng tôi</p>
    </div>

    <div class="row">
        <!-- Sidebar Filter -->
        <div class="col-lg-3 mb-4">
            <div class="filter-sidebar">
                <h5 class="mb-3">Danh Mục</h5>
                <div class="list-group mb-4">
                    <a href="@Url.Action("Index", "Products")"
                       class="list-group-item list-group-item-action @(string.IsNullOrEmpty(category) ? "active" : "")">
                        Tất Cả
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "tra-sua" })"
                       class="list-group-item list-group-item-action @(category == "tra-sua" ? "active" : "")">
                        🧋 Trà Sữa
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "tra" })"
                       class="list-group-item list-group-item-action @(category == "tra" ? "active" : "")">
                        🍵 Trà
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "trai-cay" })"
                       class="list-group-item list-group-item-action @(category == "trai-cay" ? "active" : "")">
                        ☕ Cà Phê
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "sinh-to" })"
                       class="list-group-item list-group-item-action @(category == "sinh-to" ? "active" : "")">
                        🥤 Sinh Tố
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "nuoc-ep" })"
                       class="list-group-item list-group-item-action @(category == "nuoc-ep" ? "active" : "")">
                        🍹 Nước Ép
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "soda" })"
                       class="list-group-item list-group-item-action @(category == "soda" ? "active" : "")">
                        🥂 Soda
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "banh-ngot" })"
                       class="list-group-item list-group-item-action @(category == "banh-ngot" ? "active" : "")">
                        🍰 Soda
                    </a>
                    <a href="@Url.Action("Index", "Products", new { category = "banh-ngot" })"
                       class="list-group-item list-group-item-action @(category == "banh-ngot" ? "active" : "")">
                        Bánh Ngọt
                    </a>
                </div>

                <h5 class="mb-3">Khoảng Giá</h5>
                <div class="list-group mb-4">
                    <a href="#" class="list-group-item list-group-item-action" onclick="filterByPrice(0, 30000); return false;">
                        Dưới 30.000đ
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" onclick="filterByPrice(30000, 50000); return false;">
                        30.000đ - 50.000đ
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" onclick="filterByPrice(50000, 70000); return false;">
                        50.000đ - 70.000đ
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" onclick="filterByPrice(70000, 999999); return false;">
                        Trên 70.000đ
                    </a>
                </div>
            </div>
        </div>

        <!-- Products Grid -->
        <div class="col-lg-9">
            <!-- Toolbar -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <span class="text-muted">Hiển thị <span id="productCount">0</span> sản phẩm</span>
                </div>
                <div class="d-flex gap-2">
                    <select class="form-select form-select-sm" id="sortSelect" style="width: auto;">
                        <option value="">Sắp xếp</option>
                        <option value="price-asc" @(sort == "price-asc" ? "selected" : "")>Giá: Thấp đến Cao</option>
                        <option value="price-desc" @(sort == "price-desc" ? "selected" : "")>Giá: Cao đến Thấp</option>
                        <option value="name-asc" @(sort == "name-asc" ? "selected" : "")>Tên: A-Z</option>
                        <option value="name-desc" @(sort == "name-desc" ? "selected" : "")>Tên: Z-A</option>
                        <option value="popular" @(sort == "popular" ? "selected" : "")>Phổ Biến</option>
                    </select>
                </div>
            </div>

            <!-- Products Grid -->
            <div class="row g-4" id="productsContainer" data-category="@category">
                <!-- Products will be loaded here by JavaScript from API -->
                <div class="col-12 text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Đang tải sản phẩm...</span>
                    </div>
                    <p class="mt-2 text-muted">Đang tải danh sách sản phẩm...</p>
                </div>
            </div>

            <!-- Pagination -->
            <nav aria-label="Products pagination" class="mt-5">
                <ul class="pagination justify-content-center" id="pagination">
                    <!-- Pagination will be loaded by JavaScript -->
                </ul>
            </nav>
        </div>
    </div>
</div>

@section styles {
    <style>
        .products-page {
            padding: 2rem 0;
        }

        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .filter-sidebar {
            background: #fff;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            position: sticky;
            top: 80px;
        }

            .filter-sidebar h5 {
                color: var(--primary-color);
                font-weight: 600;
                padding-bottom: 0.5rem;
                border-bottom: 2px solid var(--primary-color);
            }

        .list-group-item {
            border: none;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
        }

            .list-group-item:hover {
                background: #f8f9fa;
                border-left-color: var(--primary-color);
                transform: translateX(5px);
            }

            .list-group-item.active {
                background: var(--primary-color);
                border-left-color: var(--accent-color);
                color: white;
            }

        .product-card {
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

            .product-card:hover {
                transform: translateY(-10px);
                box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            }

        .product-image {
            position: relative;
            padding-top: 100%;
            overflow: hidden;
            background: #f8f9fa;
        }

            .product-image img {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 1;
        }

        .product-info {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333;
            min-height: 2.6em;
        }

        .product-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            flex-grow: 1;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
        }

        .product-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .btn-add-cart {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

            .btn-add-cart:hover {
                background: var(--accent-color);
                transform: scale(1.05);
            }

        .pagination .page-link {
            color: var(--primary-color);
            border: 1px solid #ddd;
            margin: 0 5px;
            border-radius: 8px;
        }

            .pagination .page-link:hover {
                background: var(--primary-color);
                color: white;
                border-color: var(--primary-color);
            }

        .pagination .page-item.active .page-link {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        @@media (max-width: 991px) {
            .filter-sidebar {
                position: static;
            }
        }
    </style>
}

@section scripts {
    <script src="~/Scripts/products-api.js"></script>
}
